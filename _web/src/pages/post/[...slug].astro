---
import { getCollection, render } from "astro:content";
import BlogPost from "../../layouts/BlogPost.astro";
import Code from "../../components/Code.astro";
import Aside from "../../components/Aside.astro";

export async function getStaticPaths() {
  const posts = await getCollection("posts");

  /**
   * note: ALL posts are publically available
   * even if they have `publish: false` in their frontmatter
   */

  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;
const { Content } = await render(post);
const { type } = post.data;
---

<BlogPost post={post}>
  <Content components={{ Code, Aside }} />
</BlogPost>
